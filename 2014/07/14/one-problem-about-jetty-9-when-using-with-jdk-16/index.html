<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.82.0"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta property="og:title" content="jetty 9运行在jdk1.6时假死问题"><meta name=author content="Dongfang Qu"><meta name=keywords content="jetty,jdk"><meta name=description content="代码 package com.baidu.oped.aqueducts.server.status; import org.eclipse.jetty.server.Server; import org.apache.logging.log4j.LogManager; …"><meta property="og:title" content="jetty 9运行在jdk1.6时假死问题"><meta property="og:description" content="代码 package com.baidu.oped.aqueducts.server.status; import org.eclipse.jetty.server.Server; import org.apache.logging.log4j.LogManager; import org.apache.logging.log4j.Logger; import org.eclipse.jetty.server.nio.SelectChannelConnector; import com.baidu.oped.aqueducts.rpc.MetricsHandler; import com.baidu.oped.aqueducts.server.status.servlet.RpcServerStatusServlet; /** * http interface to get rpc server status * * @author qudongfang * @since JDK1.6 */ public class JettyServer { private static final Logger LOG = LogManager.getLogger(JettyServer.class.getName()); private MetricsHandler metricsHandler; private int port; public JettyServer(MetricsHandler m, int p) { this.metricsHandler = m; this.port = p; } public void start() { Server server = new Server(); // Set the connector SelectChannelConnector connector = new SelectChannelConnector(); connector."><meta property="og:type" content="article"><meta property="og:url" content="https://www.concurrent.work/2014/07/14/one-problem-about-jetty-9-when-using-with-jdk-16/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2014-07-14T00:00:00+00:00"><meta property="article:modified_time" content="2014-07-14T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="jetty 9运行在jdk1.6时假死问题"><meta name=twitter:description content="代码 package com.baidu.oped.aqueducts.server.status; import org.eclipse.jetty.server.Server; import org.apache.logging.log4j.LogManager; import org.apache.logging.log4j.Logger; import org.eclipse.jetty.server.nio.SelectChannelConnector; import com.baidu.oped.aqueducts.rpc.MetricsHandler; import com.baidu.oped.aqueducts.server.status.servlet.RpcServerStatusServlet; /** * http interface to get rpc server status * * @author qudongfang * @since JDK1.6 */ public class JettyServer { private static final Logger LOG = LogManager.getLogger(JettyServer.class.getName()); private MetricsHandler metricsHandler; private int port; public JettyServer(MetricsHandler m, int p) { this.metricsHandler = m; this.port = p; } public void start() { Server server = new Server(); // Set the connector SelectChannelConnector connector = new SelectChannelConnector(); connector."><link rel=stylesheet type=text/css media=screen href=/css/normalize.css><link rel=stylesheet type=text/css media=screen href=/css/main.css><link rel=stylesheet type=text/css media=screen href=/css/all.css><link rel=stylesheet href=/css/katex.min.css crossorigin=anonymous><script defer src=/js/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script><script defer src=/js/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><title>jetty 9运行在jdk1.6时假死问题 | Concurrent Work</title></head><body><header><div id=titletext><h2 id=title><a href=https://www.concurrent.work>Concurrent Work</a></h2></div><div id=title-description><p id=subtitle>Rambling of a coder who craves for knowledge and understanding of the world.</p><div id=social><nav><ul><li><a href=https://github.com/qudongfang><i title=Github class="icons fab fa-github"></i></a></li><li><a href=https://www.linkedin.com/in/qudongfang/><i title=LinkedIn class="icons fab fa-linkedin"></i></a></li><li><a href=https://twitter.com/qudongfang><i title=Twitter class="icons fab fa-twitter"></i></a></li></ul></nav></div></div><div id=mainmenu><nav><ul><li><a href=/posts>All Posts</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li></ul></nav></div></header><main><div class=post><div class=author><p>Written by Dongfang Qu</p></div><div class=post-header><div class=meta><div class=date><span class=day>14</span>
<span class=rest>Jul 2014</span></div></div><div class=matter><h1 class=title>jetty 9运行在jdk1.6时假死问题</h1></div></div><div class=markdown><h2 id=代码>代码</h2><pre><code>package com.baidu.oped.aqueducts.server.status;

import org.eclipse.jetty.server.Server;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import org.eclipse.jetty.server.nio.SelectChannelConnector;

import com.baidu.oped.aqueducts.rpc.MetricsHandler;
import com.baidu.oped.aqueducts.server.status.servlet.RpcServerStatusServlet;

/**
 * http interface to get rpc server status
 *
 * @author qudongfang
 * @since JDK1.6
 */

public class JettyServer {

    private static final Logger LOG = LogManager.getLogger(JettyServer.class.getName());
    private MetricsHandler metricsHandler;
    private int port;

    public JettyServer(MetricsHandler m, int p) {
        this.metricsHandler = m;
        this.port = p;
    }

    public void start() {
        Server server = new Server();

        // Set the connector
        SelectChannelConnector connector = new SelectChannelConnector();
        connector.setPort(this.port);
        server.addConnector(connector);

        // Set a handler
        server.setHandler(new RpcServerStatusServlet(this.metricsHandler));

        // Start the server
        try {
            LOG.info(&quot;starting jetty server ...&quot;);
            server.start();
            LOG.info(&quot;jetty server started.&quot;);
        } catch (Exception e) {
            LOG.error(&quot;jetty server start failed.&quot;);
            System.exit(-1);
        }
    }
}
</code></pre><h2 id=现象>现象</h2><p>编译通过，运行时无异常，代码卡死在server.start()，太TMD坑爹了。。。</p><h2 id=解决方法>解决方法</h2><p>切换低版本的jetty。</p><h2 id=后记>后记</h2><ol><li>自己太傻比，贪新版本，没仔细看release notes。</li><li>你问我为啥还要使用jdk 1.6？坑爹的狼长线上服务器操作系统版本太低呀。。。</li></ol></div><div class=tags><div class=taxosfloating_left><p>Categories</p></div><div class=termsfloating_right><p><a href=/categories/java/>java</a>
<a href=/categories/jdk/>jdk</a>
<a href=/categories/jetty/>jetty</a></p></div><div class=clearit></div><div class=tags><div class=taxosfloating_left><p>Tags</p></div><div class=termsfloating_right><p><a href=/tags/jdk/>jdk</a>
<a href=/tags/jetty/>jetty</a></p></div><div class=clearit></div></div></div></main><footer>©Copyright | <a href=https://github.com/qudongfang/>Concurrent work</a></footer></body></html>